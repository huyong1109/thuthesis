%
% ================= IF YOU HAVE QUESTIONS =======================
% Questions regarding the SIGS styles, SIGS policies and
% procedures, Conferences etc. should be sent to
% Adrienne Griscti (griscti@acm.org)
%
% Technical questions _only_ to
% Gerald Murray (murray@hq.acm.org)
% ===============================================================
%
% For tracking purposes - this is V2.0 - May 2012

\documentclass{sig-alternate-05-2015}
\usepackage{gensymb}  %format of algorithm
\usepackage{algorithm}  %format of algorithm
\usepackage{algorithmic}  %format of algorithm
\renewcommand{\algorithmiccomment}[1]{ \hfill {/* #1 */} }
\usepackage{graphicx}
\usepackage{epstopdf}



\DeclareGraphicsExtensions{.eps,.mps,.pdf,.jpg,.PNG}
\DeclareGraphicsRule{*}{pdf}{*}{}
\graphicspath{{./fig/}}

\usepackage{color}
\newcommand{\hl}[1]{\textcolor{red}{#1}}

\newcommand{\superscript}[1]{\ensuremath{^{\textrm{#1}}}}
\def\sharedaffiliation{\end{tabular}\newline\begin{tabular}{c}}
\def\thua{\superscript{\dag}}
\def\thub{\superscript{\ddag}}
\def\ncara{\superscript{*}}
\def\ncarb{\superscript{\P}}

\begin{document}
%
% --- Author Metadata here ---
\setcopyright{usgovmixed}
\conferenceinfo{SC '15,}{November 15-20, 2015, Austin, TX, USA}
\isbn{978-1-4503-3723-6/15/11}\acmPrice{\$15.00}
\doi{http://dx.doi.org/10.1145/2807591.2807596}


%\conferenceinfo{SC'15}{November 15-20, 2015, Austin, Texas, USA.}
%\CopyrightYear{2007} % Allows default copyright year (20XX) to be over-ridden - IF NEED BE.
%\crdata{0-12345-67-8/90/01}  % Allows default copyright data (0-89791-88-6/97/05) to be over-ridden - IF NEED BE.
% --- End of Author Metadata ---

%\title{Alternate {\ttlit ACM} SIG Proceedings Paper in LaTeX
%Format\titlenote{(Produces the permission block, and
%copyright information). For use with
%SIG-ALTERNATE.CLS. Supported by ACM.}}
%\subtitle{[Extended Abstract]
%\titlenote{A full version of this paper is available as
%\textit{Author's Guide to Preparing ACM SIG Proceedings Using
%\LaTeX$2_\epsilon$\ and BibTeX} at
%\texttt{www.acm.org/eaddress.htm}}}

\title{Improving the Scalability of the Ocean Barotropic Solver \\in the Community Earth System Model}
%
% You need the command \numberofauthors to handle the 'placement
% and alignment' of the authors beneath the title.
%
% For aesthetic reasons, we recommend 'three authors at a time'
% i.e. three 'name/affiliation blocks' be placed beneath the title.
%
% NOTE: You are NOT restricted in how many 'rows' of
% "name/affiliations" may appear. We just ask that you restrict
% the number of 'columns' to three.
%
% Because of the available 'opening page real-estate'
% we ask you to refrain from putting more than six authors
% (two rows with three columns) beneath the article title.
% More than six makes the first-page appear very cluttered indeed.
%
% Use the \alignauthor commands to handle the names
% and affiliations for an 'aesthetic maximum' of six authors.
% Add names, affiliations, addresses for
% the seventh etc. author(s) as the argument for the
% \additionalauthors command.
% These 'additional authors' will be output/set for you
% without further effort on your part as the last section in
% the body of your article BEFORE References or any Appendices.

% \numberofauthors{6}
% \author{
% % 1st. author
% \alignauthor
% Yong Hu\titlenote{
% Ministry of Education Key Laboratory for Earth System Modeling, Center for Earth System Science,
% and Joint Center for Global Change Studies, Beijing, 100875, China. }
% \\
% %  \affaddr{Department of Computer Science \& Technology }\\
%  % \affaddr{Center for Earth System Science } \\
%   \affaddr{Tsinghua University} \\
%   \affaddr{Beijing, China} \\
%   \email{huyong11@tsinghua.edu.cn}
% % 2nd
% \alignauthor
% Xiaomeng Huang\raisebox{9pt}{$\ast$} \\
% %\affaddr{Center for Earth System Science } \\
%  \affaddr{Tsinghua University} \\
%   \affaddr{Beijing, China} \\
%   \email{hxm@tsinghua.edu.cn}
% %3rd
% \alignauthor
% Allison H. Baker\\
% %\affaddr{Computational and Information Systems Laboratory}\\
%    \affaddr{National Center for Atmospheric Research}\\
%    \affaddr{Boulder, CO}\\
%    \email{abaker@ucar.edu}
% %more
% \and
% \alignauthor
% Yu-heng Tseng\\
%  % \affaddr{Climate and Global Dynamics Division} \\
%   \affaddr{National Center for Atmospheric Research}\\
%   \affaddr{Boulder, CO}\\
%   \email{ytseng@ucar.edu}
% \alignauthor
% Frank O. Bryan\\
% % \affaddr{Climate and Global Dynamics Division} \\
%   \affaddr{National Center for Atmospheric Research}\\
%   \affaddr{Boulder, CO}\\
%   \email{bryan@ucar.edu}
% \alignauthor
% John M. Dennis\\
% % \affaddr{Climate and Global Dynamics Division} \\
%   \affaddr{National Center for Atmospheric Research}\\
%   \affaddr{Boulder, CO}\\
%   \email{dennis@ucar.edu}
% \alignauthor
% Guangwen Yang\raisebox{9pt}{$\ast$}\\
% % \affaddr{Center for Earth System Science } \\
% \affaddr{Tsinghua University} \\
% \affaddr{Beijing, China} \\
% \email{ygw@tsinghua.edu.cn}
% }


\numberofauthors{1}
\author{
\alignauthor
Yong Hu\thua, Xiaomeng Huang\thua, Allison H. Baker\ncarb,\\Yu-heng Tseng\ncara, Frank O. Bryan\ncara,  John M. Dennis\ncarb, Guangwen Yang\thua
\sharedaffiliation
  \begin{tabular}{ccc}
    \affaddr{{\thua}  {Center for Earth System Science\ }} & & \affaddr{{\ncara}Climate and Global Dynamics Division {\ }} \\
    \affaddr{Tsinghua University, 100084, and  {\ } } & & \affaddr{{\ncarb}Computational and Information Systems Laboratory{\ }} \\
      \affaddr{ Joint Center for Global Change Studies {\ } } & & \affaddr{National Center for Atmospheric Research} \\
    \affaddr{Beijing, 100875, China} & & \affaddr{Boulder,CO. USA} \\
   \email{\{huyong11,hxm,ygw\}@tsinghua.edu.cn}  & & \email{\{abaker,ytseng,bryan,dennis\}@ucar.edu} \\
  \end{tabular}
}


% \numberofauthors{1}
% \author{
% \alignauthor
% Yong Hu\thua\thub,Yu-heng Tseng\ncara,Allison H. Baker\ncarb, \\Xiaomeng Huang\thub, Frank O. Bryan\ncara, Guangwen Yang\thua\thub
% \sharedaffiliation
%   \begin{tabular}{ccc}
%     \affaddr{{\thua}Department of Computer Science \& Technology {\ }} & & \affaddr{{\ncara}Climate and Global Dynamics Division {\ }} \\
%     \affaddr{{\thub} Center for Earth System Science{\ } } & & \affaddr{{\ncarb}Computational and Information Systems Laboratory{\ }} \\
%     \affaddr{Tsinghua University,Beijing,China} & & \affaddr{National Center for Atmospheric Research} \\
%     \email{huyong11@mails.tsinghua.edu.cn} & & \affaddr{Boulder,CO. USA} \\
%     \email{\{hxm,ygw\}@tsinghua.edu.cn}  & & \email{\{ytseng,abaker,bryan\}@ucar.edu} \\
%   \end{tabular}
% }



%\sharedaffiliation
%  \begin{tabular}{ccc}
%    \affaddr{{\thu}Ministry of Education Key Laboratory for Earth System Modeling{\ }} & & \affaddr{{\ncar}Climate and Global Dynamics Division, Computational and Information Systems Laboratory{\ }} \\
%    \affaddr{Center for Earth System Science, Tsinghua University, Beijing, 100084, China}            & & \affaddr{National Center for Atmospheric Research} \\
%    \affaddr{Tsinghua National Laboratory for Information Science and Technology (TNList)}            & & \affaddr{1850 Table Mesa Dr., Boulder, CO80305, USA} \\
%    \affaddr{United States}                  & & \affaddr{United States} \\
%  \end{tabular}
%


% There's nothing stopping you putting the seventh, eighth, etc.
% author on the opening page (as the 'third row') but we ask,
% for aesthetic reasons that you place these 'additional authors'
% in the \additional authors block, viz.
%\additionalauthors{Additional authors: John Smith (The Th{\o}rv{\"a}ld Group,
%email: {\texttt{jsmith@affiliation.org}}) and Julius P.~Kumquat
%(The Kumquat Consortium, email: {\texttt{jpkumquat@consortium.net}}).}
\date{30 March 2015}
% Just remember to make sure that the TOTAL number of authors
% is the number that will appear on the first page PLUS the

% number that will appear in the \additionalauthors section.



\maketitle
%ABSTRACT needs to be 150 words that we submit on web site - not in
%actual paper
\begin{abstract}
  

  高分辨率气候模拟的需求量与日剧增，它所消耗的计算资源也是极其巨大。 
  在公共地球系统模式（CESM）中， 并行海洋模式（POP）在高分辨网格（比如0.1度）的配置下的计算量极其巨大，在很多真实运行的实例中都是公共地球系统模式CESM中可扩展性最差的一个分量模式。 
  尤其是在正压模态中求解椭圆方程所用到的改进后的预处理共轭梯度法（PCG）， 在大核数并行使可扩展很差， 从而成为了高分辨率的模拟中的一个主要瓶颈。 
  此论文中，我们证明了正压求解器中的通信开销在整个海洋模式POP的运行时间中所占的比随着并行核数的增加而增加。 
  为了解决这一问题， 我们在海洋模式POP中实现了一个预处理的Chebyshev迭代方法（称之为P-CSI方法）， 它所需要的全局归约操作要比预处理共轭梯度法少很多。 
  我们还研发了一个高效的基于误差向量传播方法的块预处子，它是的P-CSI方法能在比较少的迭代步内收敛。 
  我们还证明了P-CSI由于可扩展性得到改善， 在16,875核上对高分辨海洋模式POP的正压模态加速了5.2倍，并且是的整个POP的模拟速率提高了1.7倍。 
  最后，我们还通过一个基于集合模拟的统计学方法来证明使用了我们的新的求解器后产生的模拟结果是与原始结果相容的。


\end{abstract}


% \begin{abstract}
%   The increasing need for high-resolution climate simulations warrants
%   the investigation of a new preconditioned linear solver for the
%   barotropic mode in the Parallel Ocean Model (POP).  POP is the ocean
%   component of the Community Earth System Model (CESM) framework and
%   is computationally expensive for high-resolution grids (e.g.,
%   0.1\degree) on many cores.  Similar to other free-surface models,
%   POP solves the fast barotropic dynamics with the implicit
%   free-surface method.  This method requires the solution of an
%   elliptic system of equations, and POP solves this elliptic system
%   with a modified Preconditioned Conjugate Gradient (PCG) method.
%   While effective at moderate core counts and resolutions, PCG methods
%   scale poorly on large parallel systems due to the global reductions
%   required by the inner product calculations.  This poor scaling is
%   problematic for high-resolution CESM simulations.  In this work, we
%   implement a more scalable Preconditioned Stiefel Iteration method
%   (P-CSI) into the barotropic mode of POP within CESM, and develop an
%   effective Error Vector Propagation preconditioner to improve the
%   convergence rate.  Our experiments show that P-CSI accelerates the
%   high-resolution (0.1\degree) barotropic solver by 7.1 times on
%   16,875 cores, from 21.84s to 3.06s per simulation day.  This
%   improves the core POP simulation (without I/O and initialization) by
%   1.74 times, from 5.3 to 9.3 simulated years per wall-clock day.
%   Further, to ensure that the use of an alternative solver in POP does
%   not negatively impact the ocean climate, we use an ensemble-based
%   statistical method to evaluate the impact of the new solver.
% \end{abstract}







% A category with the (minimum) three required fields
\category{J.2}{Physical Sciences and Engineering}{Earth and atmospheric sciences}
%A category including the fourth, optional field follows...
\category{D.1.3}{Programming Techniques}{Parallel Programming}

%it's OK not to have general terms
%\terms{Algorithms, Performance}
%\keywords{Massive Parallelism, Preconditioned Conjugate Gradient, Classical Stiefel Iteration, Parallel Ocean Program}
\keywords{parallel computing, linear solver, ocean modeling}
\input{introduction}
\input{barotropic}
\input{pcsisolver}
\input{evpprecond}
\input{experiment}
\input{verification}
\input{relatedwork}

%----------------------------------------------------------------------------
\section{Conclusion} \label{se:conc}

 
由于海洋模式POP中的ChronGear正压求解在大核数上的不良表现， 高分辨的公共地球系统模式CESM的可扩展性也不太好。
这篇文章通过采用一个需要更少全局归约操作的新的求解器和一个专门为正压模态设计的基于误差向量传播方法的块预处理子，最终改进了求解器的性能。 
我们评估了这个最终的求解器，也就是采用EVP块预处理的P-CSI方法，在两个经常用来运行公共地球系统模式的超级计算机上的性能，并且发现新的求解器相对于原始的求解器有了高达5倍的性能提升。
同时，我们通过海洋模式POP中的一个基于集合模拟的一致性检验工具证明了我们的新的求解器不会影响海洋模式的模拟结果。 
这也使得我们的新的求解器最终可以出现在公共地球系统模式的下一个版本中。 
新的求解器将会有助于未来的低分辨率和高分辨率公共地球系统模式的模拟， 尤其是过去被海洋模式POP分量影响到可扩展性的全耦合模式。 

% Low resolutions will also benefit as they are typically run for very long time periods.


% Even though the new barotropic solvers have more benefit in high
% resolution simulations, it also contributes to the low resolution
% simulations.  The P-CSI solver is verified to maintain a stable ocean
% climate within a small tolerance using an ensemble based statistical
% method.  In closing, this paper highlights a scalable and robust
% barotropic solver for free-surface ocean models.




%ACKNOWLEDGMENTS are optional
\section{Acknowledgments}
Computing resources were provided by the Climate
Simulation Laboratory at NCAR's Computational and Information Systems
Laboratory (sponsored by the NSF and other
agencies) and the National Energy Research Scientific Computing
Center, a DOE Office of Science User Facility supported by the Office
of Science of the U.S. Department of Energy under Contract
No. DE-AC02-05CH11231.

This work is supported in part by a grant from the National Natural Science Foundation
of China (41375102), the National Grand Fundamental Research 973 Program of China (No. 2014CB347800), and the National High Technology Development Program of China
(2011AA01A203).


%Generated by bibtex from your ~.bib file.  Run latex,
%then bibtex, then latex twice (to resolve references)
%to create the ~.bbl file.  Insert that ~.bbl file into
%the .tex source file and comment out
%the command \texttt{{\char'134}thebibliography}.
\bibliographystyle{abbrv}
\bibliography{hycs}  % sigproc.bib is the name of the Bibliography in this case
% This next section command marks the start of
% Appendix B, and does not continue the present hierarchy
%\section{More Help for the Hardy}
%The sig-alternate.cls file itself is chock-full of succinct
%and helpful comments.  If you consider yourself a moderately
%experienced to expert user of \LaTeX, you may find reading
%it useful but please remember not to change it.
%\balancecolumns % GM June 2007
% That's all folks!
\end{document}
