\chapter{绪论}
\label{cha:intro}

\section{气候变化}

近年来，气候变化不仅是气候研究领域的热门，也是新闻媒体和人们日常谈论的热点。
上个世纪以来，科学家们通过观测发现，地球气候发生了很多重大改变，如大气中的二氧化碳的浓度的不断增加，全球生态氮循环的改变，以及陆地的分布和使用的改变等\cite{vitousek1994beyond}。
全球气候的变化，不仅影响着水资源，能源的供应和使用，交通运输，农业，生态系统和人类健康等与人类日常生活息息相关的方方面面\cite{karl2009global}，同时也改变着整个地球的生态系统，从而又间接的影响到人类的生存环境。



科学研究表明，未来的气候变化更大的可能是继续朝着全球变暖的趋势发展\cite{solomon2007climate,stocker2013ipcc}。
全球气候变暖的最直接的影响是导致冰川、动土和海冰的消融，进而导致的海平面的上升，以及亚热带沙漠地区面积的扩大等，这些改变都会直接威胁到人类的生存。
气候变暖还会导致极端天气，如热潮、干旱、严重暴雨引发的洪水、大雪等发生的频繁的增加，也极大的影响到人类的日常生活。
全球气候变暖对农业生产活动也有着重大的影响。 随着全球气候的不断变暖，农产品收获季节温度的不断升高，玉米和大豆等主要农作物的生长周期变短， 农作物的产量受到很大影响， 进而威胁到农场的收成，乃至全球的粮食安全\cite{battisti2009historical,adams1990global,smith1989potential}。 

人类的活动与气候变化之间有着密切的联系和相互作用。
人类的活动，比如使用氮肥、或者燃烧化石燃料等对全球氮循环带来的巨大的影响。这些影响甚至超过了自然过程中的影响，进而对生物多样性造成了不可估量的影响。
过去的60年里，人类对自然生态系统造成的改变要比过去任何时期的都要剧烈和广泛。众多证据表明，人类化石燃料的燃烧，使得大气中的二氧化碳浓度从1800年的280微升每升增加到二十世纪初的355微升每升\cite{vitousek1994beyond}. 
反过来，由于温室效应，导致了全球气候变暖，不仅改变了地球的生态系统，也影响着人类的生存环境。生态环境为人类所提供的“服务”中，从空气质量的改善到水的净化，60\%左右不是被破坏，就是无法可持续性的使用\cite{assessment2005ecosystems}。



气候变化同时也给地球上的生态环境造成重大影响。
已有研究表明，气候的变化给全球生态系统带来了很多重大改变，全球植被的分布和生命周期正在逐年改变\cite{parmesan2003globally}。
过去三十年中，气候变化对物种的分布和多样性造成了很多重大的影响，甚至导致了很多物种层面的灭绝。据预测，到2050年，当前人类资料库中的15–37\%左右的物种都会面临灭绝 \cite{thomas2004extinction} 。
海洋温度的升高，极大的改变了海洋生物的分布。研究显示1980年到2005年间，北海中大约有三分之二的种群迁移到了中纬度地区或者更深的海域。
未来温度的继续升高，可能会导致物种分布上的继续偏移，进而通过种群之间的相互作用，对渔业造成深远影响\cite{perry2005climate} 。
气候变化已经导致地球上很多区域的物种分布发生了变化。 
有研究预测，2080年，欧洲一半以上的植物物种将会受到威胁\cite{thuiller2005climate} 。

 
正是由于气候变化跟人们的生活息息相关，全球各个国家都在积极的研究气候现象，预测未来气候变化趋势，以应对气候变化可能带来的影响。 
随着科技的发展，人们不满足于对气候变化规律的解释，而是利用计算机来对气候系统进行建模，进而预测未来的气候。
近几年，随着计算机科学的发展，气候模式的应用也逐渐得到了推广。  



 
\section{气候系统模式}

为了促进对全球气候现象的理解，增强对未来气候变化的预测能力，科学家们通过数学模型来对地球上的大气和海洋等气候系统进行模拟，并逐渐发展成为相应的气候模式。
气候模式是用来研究气候系统对各种强迫的响应的基本工具，它被用来进行短的如季节性、长如几十年、一个世纪、甚至更长的时间的气候预测。 
借助计算机强大的计算能力， 气候模型能够整合长时间、全球范围内的物理、化学和生态等过程，促进人们对地球系统的理解\cite{hurrell2013community}。


气候模式最初是模拟大气、海洋、海冰等相对独立的气候系统。随着观测数据的丰富、模拟能力的增强，后来逐渐出现了耦合气候系统模式。耦合气候系统模式是为了更加真实的模拟地球上大气、海洋、陆地等相对独立的气候系统之间的相互作用，而将这些的气候模式通过耦合器连接起来。
早期的耦合模式主要是大气海洋环流模式。他们的基本功能是去理解大气、海洋、陆地和海冰等气候系统中动力过程，并且基于未来温室效应和气溶胶强迫的假设进行气候预测。在2007年的政府间气候变化专门委员会（the
Intergovernmental Panel on Climate Change， IPCC) 第四次评估报告（the Fifth Assessment
Report， AR4)中，大气海洋环流模式是比较通用的气候模式\cite{solomon2007climate}。
近年来，在大气海洋环流模式的基础上，科学家们又扩展了多个生物地理化学循环圈， 比如碳循环、硫循环和臭氧等， 进而发展成为地球系统模式。 地球系统模式是目前气候模式比较前沿的一种形式，
这些模式为模拟过去、现在和未来的气候系统对于外界强迫的响应提供了一个最为全面的工具。 

人们对气候变化的关注也促使了全球各个国家积极的发展自己的耦合气候模式。
在2013年的政府间气候变化专门委员会第五次评估报告（IPCC AR5)中，有来自13个国家近四十个模拟结果，
其中包括中国国家气候中心和北京师范大学各提交的一组结果，中科院大气物
理研究所大气科学和地球流体力学数值模拟国家重点实验室（LASG）提交的两个结果\cite{stocker2013ipcc}。



\subsection{公共气候系统模式}
 

 
目前，以美国国家大气研究中心（the National Center for Atmospheric Research， NCAR) 主导开发的
公共地球系统模式（the Community Earth System Model， CESM) 是应用最为广泛的全球气候模式之一\cite{hurrell2013community}。
在政府间气候变化专门委员会第五次评估报告（IPCC AR5)中，直接或间接使用公共地球系统模式的预测结果占了相当大的比例 \cite{stocker2013ipcc}。
 

公共地球系统模式是一个全耦合的气候系统模式，它包括了大气、海洋、海冰和陆面等分量模式。
公共地球系统模式的海洋模式和海冰模式分量分别采用的是美国Los Alamos 国家实验室研发的并行海洋模式（The Parallel Ocean Program，POP）和公共海冰模式（The Community Ice CodE，CICE）改进后的版本。
POP是一个分层的原始方程模型，默认将海底分成厚度从海表的10米到深海处的250米不等的60层。
CICE是一个描述海冰的二维模型，它通常采用的网格与POP中使用的水平网格一致，并且有一个正交的垂直维度来表示海冰的厚度。 
大气模式分量和陆面模式分量分别采用的是美国国家大气研究中心主导开发的公共大气模式（The Community Atmosphere Model， CAM) 和公共陆面模式（The Community Land Model，CLM)。 
CAM描述的是由地球表面到约140千米高空之间的大气层。它包括了大气动力和物理过程，以及与他们紧密耦合的大气化学过程等。
CLM主要是为了研究陆面生态系统在物理、化学和生态等过程中与气候在不同的时间和空间尺度上的相互影响。
它模拟的主体是陆面生态系统中能量、水、化学元素和尾气等循环，这些都是很重要的气候决定因素。
陆面是气候与人类和生态系统之间一个重要的桥梁，人类和生态环境正是通过陆面改变着全球环境。
这些分量模式通过一个耦合器（CPL）协调和控制他们之间的二维边界的数据交换。

 

\subsection{气候系统模式的发展趋势}

为了更精准的描述大气海洋等的运动规律，更准确的预测未来气候变化，气候系统模式都朝着更高分辨率、更多分量模式和更多物理过程的方向发展。
近年来，高分辨率全球气候模式已经成为了理解气候现象和预测未来气候变化的一个不可或缺的手段。
更高分辨率使得能够模拟出小尺度运动，如涡旋和海浪。 
近几年高分辨率全球气候模式的发展表明，提高模式的分辨有助于更好的模拟重要气候过程，进而改善气候预测的结果。
提高分辨率可以极大的改善赤道不稳定波\citep{roberts2009impact}、厄尔尼诺南方涛动(ENSO) \citep{shaffrey2009uk}、墨西哥湾流\citep{chassignet2008gulf, kuwano2010precipitation} 、全球水循环\citep{demory2014role}等气候现象。
文章\inlinecite{gent2010improvements} 和\inlinecite{wehner2014effect}的研究表明提高大气模式的分辨率可以模拟出更好的气候平均态、更准确的赤道风暴的形成过程和更加真实的极端降水量。
文章\inlinecite{bryan2010frontal} 和 \inlinecite{graham2014importance}的研究也证明，将海洋模式的分辨率提高到涡解析度水平能够捕捉到海表高度和海表风应力之间的正相关性，同时也可以改善厄尔尼诺南方涛动周期模拟中的不对称性。



气候系统模式从最开始相对独立的大气、海洋和陆面等分量模式，发展成为大气海洋环流模式，最后通过将众多的分量模式都耦合在一起形成了目前比较成熟的地球系统模式。
近几年，地球系统模式中又加入了多个生物地理化学循环圈， 比如碳循环、硫循环和臭氧圈等。
这些过程能够模拟陆面、海洋中生物碳氮等的循环过程，进而模拟出陆面、海洋等生态系统，以及人类的活动等对气候的影响。
同时，也使得地球系统模式能够预测气候变化对于人类和生态系统可能造成的影响。



物理过程对于气候模式的模拟准确性及其关键。好的物理参数化方案能够提高模式的模拟结果，改善人们对气候过程的理解。 
当前的模式发展，主要是加入新得物理过程和改进已有物理参数化方案。 
以公共地球系统模式CESM在2013年最新发布的版本\cite{hurrell2013community}为例。大气模式CAM，为了更加真实的模拟大气的运动规律，对热力学过程，云的分块，云颗粒的形成，气溶胶的形成和消失，气溶胶和云颗粒的辐射性质、辐射传输、对流和湍流等物理参数化进行了改进。
海洋分量模式POP中，加入了丹麦海峡,法罗银行渠道,罗斯海等满溢过程，混合层的中小尺度的涡旋现象等的物理过程， 同时还对混合层和深海绝热层，以及他们之间的过渡层中的中尺度蜗旋的物理参数化方案进行了改进。
 

\subsection{气候模式在高性能计算中的挑战}

目前气候模式的发展趋势是耦合更多的分量模式，每个分量模式中不断的提高分辨率、并且加入更多的物理过程。
越来越高的分辨率和越来越多的物理过程都对高性能计算提出更高的要求。 
在第六次国际耦合模式比较计划（CMIP6）高分辨率模式比较计划（HighResMIP）中，有采用中纬度25公里分辨率甚至更高的全球模式申请实现Tier-1和Tier-2实验。 
由于所有参与CMIP6的气候模式通常需要运行数百年，这些高分辨率的模式需要使用巨大的计算资源， 以至于这些模拟的计算消耗及其之大。
以POP为例，0.1度分辨率的海洋模式需要在3亿多个网格点上进行演算。而且，
模式中分辨率提高十倍，计算开销将增加到一千倍以上。目前有很多研究工作都是在关注气候系统模式的性能\cite{Worley:2011:PCE:2063384.2063457,dennis2012computational}。 
各个气候模式中，海洋模式需要模拟的气候现象的时间尺度很大。 
海洋细粒度涡旋的空间尺度只有$\mathcal{O}$(10 - 100 km)， 比与之在动力学角度上相对应的大气中的天气系统的尺度要小一到两个量级。
而海洋环流的空间尺度则与整个地球的大小在一个量级， 与大气的运动尺度相当。



更为重要的是，气候模式通常需要模拟几十年甚至数百年。如此长期的模拟需求使得气候模式在采用高分辨率时的计算开销在目前的计算资源下完全无法承受。比如，在政府间气候变化专门委员会第五次评估报告中，大部分的公共地球系统模式的模拟都是采用的近似1度的海洋模式，组合以1度到2度的大气模式。
近几年超级计算机资源的增长以及高分辨卫星观测数据的出现促进了很多科研工作者研究如何通过提高高分辨率气候模式的并行计算效率，进而减少高分辨率模式的计算开销。
在时间尺度上，海洋模式需要模拟的气候现象也要比其他模式的大很多。 深海环流的时间尺度长达数个世纪甚至几千年，比大气中相对应的时间尺度要长几个量级。
对更高分辨率和更长模拟时间的要求，使得全球涡分辨的海洋气候模式的计算开销要比大气模式的开销大出很多\cite{bryan2010frontal,mcclean2011prototype,graham2014importance}。

正是由于气候模式对 高性能计算资源的需求十分巨大， 全球的的很多国家都为气候模拟制造了专门的高性能计算机。 比如日本2002年制造了当时最快的超级计算机“地球模拟器”专门来进行气候模式的模拟\cite{habata2003earth}。
美国国际大气研究中心，也为运行地球系统模式CESM建造了专门的超级计算机Yellostone超级计算机\cite{loft:2015}. 
国内清华大学也为进行气候模式而建造了“探索100”超级计算机。



尽管计算量巨大，目前的海洋模式并不能充分的利用已有的并行计算资源。比如针对美国地球系统模式CESM的测试表明，其中海洋模式分量的可扩展性较差，而且由于其计算量大，在整个地球系统模式中需要占用较大的计算资源。
为了能够更加常规化的运行这些高分辨的气候模式，需要我们进一步的进行算法优化，来充分的利用大规模的计算资源。
因此，解决海洋模式的并行问题，对于加速整个地球系统模式有着非常重要的意义。
我们的工作主要将集中在提高地球系统模式CESM中的可扩展性较差的海洋模式分量POP的并行效率。  
 

\subsection{气候模式的不确定性}
%========== 数值模式验证的重要性========
随着计算机计算能力的不断提高，数值模拟程序在解决实际问题和公共决策中应用得越来越广泛。 
这些数值模式的开发者和使用者，以及相关政策的制定者都会使用这些模式的模拟结果所呈现的信息。
所有受到这些数值模式影响的人都会关心这个模式和它的结果是否正确。
只有通过一定的模式验证和确认，才能解决相关人员的疑虑\cite{whitner1989guidelines,stainforth2005uncertainty}。

%========== 气候模式验证的重要性========
气候模式就是常见的一种数值模式，它能够方便地测试和验证人们在气候方面的发现，它模拟结果是公共决策中不可或缺的依据\cite{allen2002towards,reynolds1994random}。
因此，验证这些模型独立或集成后的模拟结果是至关重要的。
最直接的评估方法是利用这些模式的输出结果和观测数据相对比，并且分析相应的差别。 
这需要我们对模式和观测中的不确定性和误差有所了解。 

%========== 气候模式验证是不可能完全的========
但是，想要完全的验证和确认自然系统的数值模式是不可能做到的。这是因为自然系统本身不是封闭的，而且模式的结果也不是唯一确定的\cite{oreskes1994verification}。
有研究表明，在过去的几十年里，虽然模式在数量和质量上都得到长足的发展，但是气候变化预测的不确定性并没有减少。 
人们通过模式和观测的手段，在预测未来全球气候变化对于大气中二氧化碳浓度的长期相应时，给出的答案的概率分布非常广泛。
这表明，这些概率的分布是气候系统本质所带来的必然结果\cite{roe2007climate}。 

%数值模式如何应对不确定性
尽管无法验证模式结果的绝对正确性，但是可以做到的是寻求模式预测结果和观测结果的一致性。
通常，验证一个模式在给定问题的整个领域内都是正确的是一件非常费时费力的工作。 
因此，只有当一个模式被认为针对给定问题是有效的时候，才会对其正确性进行验证。 
模式应该是为了某一个特定的目的或者应用而开发的，它的验证也只能是与这个目的相关\cite{sargent2005verification}。
如果模式要回答一个很多样的问题，那么模式的验证就要针对每一个问题进行。
必须强调的是，这种验证是片面的，模式只能在相应的层面上得到评估，他们的预测结果本质上还是经验性的，也必然会面临一些问题的。


%气候学如何应对不确定性
在气候模式中，由于气候不确定性的本质，人们不再追求气候模式能够产生确定性的结果，
而是寻求定量的分析气候本身和气候模式的不确定性，从而结合模式模拟的结果给出相应的对于现实有意义的结论。
在政府间气候变化专门委员会的评估报告中，气候的敏感性一直是一个研究的重点。
2007年的政府间气候变化专门委员会第四次报告通过对气候平衡态的敏感性和瞬时气候响应进行量化，不仅仅考虑到它的变化范围，而且衡量一下这个范围内的概率。
这些概率的计算，不仅仅用到了专家的判断，还利用不同的观测条件得到的集合模拟。 
这使得我们有了一个比以前更加完整的模式相应不确定性的评估。 
这些现在被当成是全球耦合气候模式的标准测试集，可以用来评估后来的涉及到时间的气候变化情景实验\cite{meehl2007global}。 
 
%气候模式中定量研究的方法
目前，定量研究气候学最为有效的方法是利用集合模拟的结果作为评估依据\cite{von2013testing,reynolds1994random, allen2002towards}。
通过集合模拟得到的数据集合可以检查出某些结果所描述当前和未来状态与数据集合的统计学上的显著差别。
这种统计学的方法，最终可以给出集合模拟的一个概率分布区间，进一步可以得到模式不确定性的定量结果。
很多研究通过对不确定性进行定量的分析，显著的改善了模式的模拟结果\cite{reynolds1994random}。


\section{本文主要研究内容和主要贡献}
\subsection{主要研究内容}
本文主要对高分辨率气候模拟对计算资源消耗巨大这一热点问题进行深入研究，
逐步确定其中的瓶颈就是海洋模式的正压模态。
通过分析正压模态的通信瓶颈，我们提出了自己的解决方案，一个新的正压模态求解器。
同时，由于选择的新的求解器在收敛速度上略慢于原始的求解器， 我们需要设计一种高效的预处理方法。
我们通过分析传统预处理方法在海洋模式中性能不高的原因，找到了一种适合海洋模式的并行预处理子。 它利用椭圆微分方程上的高效求解方法--误差向量传播方法， 对每个进程所分得的数据块并行的做预处理。 
这种预处理方法极大的减少了新的求解器达到给定收敛条件所需要的迭代步数。
最后，由于模式的不确定性，我们必须首先确信新的求解器不会在统计学的意义上改变模拟的结果。 
我们采用集合模拟的手段，验证了我们求解器的正确性。 

\subsection{主要贡献}
我们的主要贡献可以总结为以下三个方面：
\begin{itemize}
 	\item 提出了基于Chebyshev迭代的海洋模式正压求解器。 新的求解器不需要利用每一步的残差来确定迭方向，而是利用系数矩阵的最大最小特征值。
    从而去掉了时间开销很大的全局通信操作，极大的改善了正压模态的可扩展性。
    \item 提出了基于误差向量传播算法的预处理子。误差向量传播算法是求解由椭圆偏微分方程十分高效的方法。
    我们利用海洋模式并行划分的特点，在每一个进程所得到数据块上使用EVP方法求解。这相当于使用原始方程的块对角矩阵的逆作为预处理。这种预处理方法使得正压求解器的迭代步数缩短到了原来的三分之一左右，进一步的提高正压求解器的性能。
    \item 提出了基于统计的模式评估方法。由于模式本身的不确定性，在模式中加入很小的改动都无法保证模式结果与原来的结果是二进制一致的。这也就使得很难验证模式中的改动是否会对模式造成气候意义上显著的改变。为此，我们提出了使用集合模拟的结果来对新的结果进行评估。 数据集合很好地反应模式结果的不确定性，我们最终得到的一致性检验工具能够很好从结果反推出模拟过程或者初始值所引入的误差。  
\end{itemize}
\subsection{主要组织结构}
本文其他章节结构如下：

第\ref{cha:related}章介绍了当前海洋模式中主要的性能优化，迭代求解器中常用的预处理方法以及气候模式中主要的验证方法。

第\ref{cha:barosSolver}章介绍了海洋模式正压模态的求解器和通信瓶颈。

第\ref{cha:precond}章介绍了本论文所提出的基于误差向量传播方法的并行预处理方法。

第\ref{cha:verify}章介绍了本论文所提出来的基于集合模拟的正确性验证方法。 

第\ref{cha:conclusion}章对整篇文论进行总结，并对未来进一步的工作进行展望。


